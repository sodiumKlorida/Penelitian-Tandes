<div class="bg-gray-100 rounded-2xl shadow-md border border-gray-300 p-4 w-80 h-40 flex items-center justify-center">
  <div id="tips-aktivitas" class="text-gray-700 text-base font-medium"></div>
</div>

<script>
  async function getTips() {
    try {
      // Panggil kedua API
      const resAqi = await fetch('/aqicn/tandes')
      const resCuaca = await fetch('/bmkg/cuaca')
  
      const dataAqi = await resAqi.json()
      const dataCuaca = await resCuaca.json()
  
      console.log('AQI:', dataAqi)
      console.log('Cuaca:', dataCuaca)
  
      let tips = 'Nikmati hari Anda 👍'
  
      if (!dataAqi.error && dataCuaca.prakiraan && dataCuaca.prakiraan.length > 0) {
        const aqi = dataAqi.aqi
        const cuaca = dataCuaca.prakiraan[0].cuaca.toLowerCase()
  
        // Kategori AQI
        let kondisiUdara = ''
        if (aqi <= 50) kondisiUdara = 'baik'
        else if (aqi <= 100) kondisiUdara = 'sedang'
        else if (aqi <= 150) kondisiUdara = 'tidak sehat sensitif'
        else if (aqi <= 200) kondisiUdara = 'tidak sehat'
        else kondisiUdara = 'berbahaya'
  
        // Tentukan tips dengan kombinasi
        if (cuaca.includes('hujan') && aqi > 100) {
          tips = 'Hujan & udara kurang sehat 🌧️😷. Sebaiknya di rumah saja.'
        } else if (cuaca.includes('hujan')) {
          tips = 'Sedang hujan 🌧️. Gunakan jas hujan & batasi aktivitas luar.'
        } else if (cuaca.includes('cerah') && aqi <= 50) {
          tips = 'Cerah & udara bersih 🌞🌱. Cocok olahraga di luar.'
        } else if (cuaca.includes('cerah') && aqi > 100) {
          tips = 'Cerah tapi udara tidak sehat 😷☀️. Gunakan masker jika keluar.'
        } else if (aqi > 150) {
          tips = 'Udara tidak sehat 🚫. Kurangi aktivitas di luar ruangan.'
        } else {
          tips = `Kondisi cuaca ${cuaca} & udara ${kondisiUdara}. Tetap jaga kesehatan.`
        }
      }
  
      document.getElementById('tips-aktivitas').innerHTML = `
          <strong>Tips Hari Ini:</strong><br>
          ${tips}
        `
    } catch (err) {
      console.error('Gagal ambil data:', err)
      document.getElementById('tips-aktivitas').innerHTML = '⚠️ Gagal memuat tips.'
    }
  }
  
  getTips()
  setInterval(getTips, 3600000) // update tiap 1 jam
</script>
